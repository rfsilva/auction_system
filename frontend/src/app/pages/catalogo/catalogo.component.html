<div class="catalogo-container">
  <div class="catalogo-header">
    <h2>Cat√°logo de Produtos</h2>
    <p class="catalogo-subtitle">Descubra produtos √∫nicos em nossos leil√µes</p>
  </div>

  <!-- Barra de busca e filtros -->
  <div class="search-bar">
    <div class="search-input-group">
      <input
        type="text"
        [(ngModel)]="filtros.titulo"
        (keyup.enter)="aplicarFiltros()"
        placeholder="Buscar produtos..."
        class="search-input">
      <button class="search-btn" (click)="aplicarFiltros()">
        üîç
      </button>
    </div>

    <div class="filter-controls">
      <button class="filter-toggle-btn" (click)="toggleFiltros()">
        {{ filtrosExpandidos ? 'Ocultar Filtros' : 'Mostrar Filtros' }}
      </button>

      <select [(ngModel)]="filtros.ordenacao" (change)="alterarOrdenacao(filtros.ordenacao!)" class="sort-select">
        <option value="recentes">Mais Recentes</option>
        <option value="preco_asc">Menor Pre√ßo</option>
        <option value="preco_desc">Maior Pre√ßo</option>
        <option value="terminando">Terminando Primeiro</option>
      </select>
    </div>
  </div>

  <!-- Filtros expandidos -->
  <div class="filters-panel" [class.expanded]="filtrosExpandidos">
    <div class="filters-content">
      <div class="filter-group">
        <label>Categoria:</label>
        <select [(ngModel)]="filtros.categoria" class="filter-select">
          <option value="">Todas as categorias</option>
          <option *ngFor="let categoria of categorias" [value]="categoria">
            {{ categoria }}
          </option>
        </select>
      </div>

      <div class="filter-group">
        <label>Pre√ßo M√≠nimo:</label>
        <input
          type="number"
          [(ngModel)]="filtros.precoMin"
          placeholder="R$ 0,00"
          class="filter-input"
          step="0.01">
      </div>

      <div class="filter-group">
        <label>Pre√ßo M√°ximo:</label>
        <input
          type="number"
          [(ngModel)]="filtros.precoMax"
          placeholder="R$ 0,00"
          class="filter-input"
          step="0.01">
      </div>

      <div class="filter-actions">
        <button class="btn btn-primary" (click)="aplicarFiltros()">
          Aplicar Filtros
        </button>
        <button class="btn btn-secondary" (click)="limparFiltros()">
          Limpar
        </button>
      </div>
    </div>
  </div>

  <div class="alert alert-error" *ngIf="error">
    {{ error }}
  </div>

  <div class="loading-spinner" *ngIf="loading">
    <div class="spinner"></div>
    <p>Carregando produtos...</p>
  </div>

  <div class="catalogo-content" *ngIf="!loading && !error">
    <!-- Estat√≠sticas -->
    <div class="results-bar" *ngIf="totalElements > 0">
      <p>{{ totalElements }} produto{{ totalElements !== 1 ? 's' : '' }} encontrado{{ totalElements !== 1 ? 's' : '' }}</p>
    </div>

    <!-- Grid de produtos -->
    <div class="produtos-grid" *ngIf="produtos.length > 0">
      <div class="produto-card" *ngFor="let produto of produtos">
        <!-- Imagem do produto -->
        <div class="produto-image">
          <img 
            [src]="produto.images[0] || '/assets/images/no-image.png'" 
            [alt]="produto.title"
            (error)="$event.target.src='/assets/images/no-image.png'">
          
          <!-- Badge de tempo restante -->
          <div class="time-badge" *ngIf="produto.isActive" [class.urgente]="produto.timeRemaining < 3600">
            {{ formatarTempoRestante(produto.timeRemaining) }}
          </div>
        </div>

        <!-- Informa√ß√µes do produto -->
        <div class="produto-info">
          <h3 class="produto-title">{{ produto.title }}</h3>
          <p class="produto-categoria" *ngIf="produto.categoria">{{ produto.categoria }}</p>
          
          <div class="produto-precos">
            <div class="preco-atual">
              <span class="label">Lance Atual:</span>
              <span class="valor">{{ formatarPreco(produto.currentPrice) }}</span>
            </div>
            <div class="incremento" *ngIf="produto.incrementMin > 0">
              <span class="label">Incremento m√≠n:</span>
              <span class="valor">{{ formatarPreco(produto.incrementMin) }}</span>
            </div>
          </div>

          <div class="produto-encerramento">
            <span class="label">Encerra em:</span>
            <span class="data">{{ produto.endDateTime | date:'dd/MM/yyyy HH:mm' }}</span>
          </div>
        </div>

        <!-- A√ß√µes -->
        <div class="produto-actions">
          <a [routerLink]="['/catalogo/produto', produto.id]" class="btn btn-primary btn-block">
            Ver Detalhes
          </a>
        </div>
      </div>
    </div>

    <!-- Estado vazio -->
    <div class="empty-state" *ngIf="produtos.length === 0">
      <div class="empty-icon">üîç</div>
      <h3>Nenhum produto encontrado</h3>
      <p>Tente ajustar os filtros ou buscar por outros termos.</p>
      <button class="btn btn-primary" (click)="limparFiltros()">
        Limpar Filtros
      </button>
    </div>

    <!-- Pagina√ß√£o -->
    <div class="pagination" *ngIf="totalPages > 1">
      <button 
        class="btn btn-sm btn-secondary" 
        (click)="paginaAnterior()" 
        [disabled]="currentPage === 0">
        Anterior
      </button>

      <div class="pagination-pages">
        <button 
          *ngFor="let page of getPaginationPages()" 
          class="btn btn-sm" 
          [class.btn-primary]="page === currentPage"
          [class.btn-secondary]="page !== currentPage"
          (click)="irParaPagina(page)">
          {{ page + 1 }}
        </button>
      </div>

      <button 
        class="btn btn-sm btn-secondary" 
        (click)="proximaPagina()" 
        [disabled]="currentPage === totalPages - 1">
        Pr√≥xima
      </button>
    </div>
  </div>
</div>